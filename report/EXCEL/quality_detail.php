<?phpclass quality_detail extends IndexExcel{ function quality_detail()	{		mysql::__construct();	}		/** in within *****/	function getWithIn( $datas ){	RETURN implode("','",explode( ',', $datas));}	/* content HTML */	 function show_content_excel()	{			if( $this -> havepost('group_by'))		{			$xlsName = 'Quality_report_'.date('Ymd').'_'.date('His').'.xls';			header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");			header("Cache-Control: no-store, no-cache, must-revalidate");			header("Cache-Control: post-check=0, pre-check=0", false);			header("Cache-Control: private");			header("Pragma: no-cache");			header("Content-Type: application/vnd.ms-excel");			header("Content-Disposition: attachment; filename=$xlsName");						switch( $this -> escPost('group_by'))			{				case 'by_quality_campaign' 	: $this -> QualityDetailByCampaign(); 	break; 				case 'by_quality_status' 	: $this -> QualityDetailByStatus(); 	break; 				case 'by_quality_agent' 	: $this -> QualityDetailByAgent(); 		break; 				case 'by_quality_qa' 		: $this -> QualityDetailByQA(); 		break; 				case 'by_quality_date' 		: $this -> QualityDetailByDates(); 		break; 			}		}	}	/** QualityDetailByQA() ****/	 function QualityDetailByDates() {	$QualityId = $this -> getWithIn($this -> escPost('group_select'));	$start_date = $this -> Date -> english( $this -> escPost('start_date'),'-' );	$end_date   = $this -> Date -> english( $this -> escPost('end_date'),'-' );	/** start header content table ***/				echo "<table class=\"grid\" cellpadding=\"0\" cellspacing=\"0\" >				<tr>				   <td class=\"header first\" nowrap>No</td>					  <td class=\"header middle\" nowrap>Campaign Name</td>				  <td class=\"header middle\" nowrap>Fine Code</td>				  <td class=\"header middle\" nowrap>Customer Name</td>				  <td class=\"header middle\" nowrap>Card Type</td>				  <td class=\"header middle\" nowrap>Address</td>				  <td class=\"header middle\" nowrap>City</td>				  <td class=\"header middle\" nowrap>Zip Code</td>				  <td class=\"header middle\" nowrap>Seller Name</td>				  <td class=\"header middle\" nowrap>Quality User</td>				  <td class=\"header middle\" nowrap>Sales Date</td>				  <td class=\"header middle\" nowrap>Approve Date</td>				  <td class=\"header middle\" nowrap align=\"center\">SLA <br>Quality</td>				  <td class=\"header middle\" nowrap>Call Reason</td>				  <td class=\"header middle\" nowrap align=\"center\" nowrap>Quality <br> Status</td>				  <td class=\"header lasted\" nowrap align=\"center\" nowrap>Quality <br> Score</td>			</tr> "; 						/** query data ******************/		$sql = " SELECT	c.CampaignName,  b.CustomerNumber, 				b.CustomerFirstName, b.CustomerCardType,				concat(					   b.CustomerAddressLine1,' ',b.CustomerAddressLine2,' ',					   b.CustomerAddressLine3 ,' ',b.CustomerAddressLine4 ) as CustomerAddressLine,				b.CustomerCity, b.CustomerZipCode, e.PolicyNumber,				CONCAT(g.id,' - ',g.full_name) as SellerName, 				CONCAT(h.id,' - ',h.full_name) as QualityUser, 				DATE_FORMAT(f.PolicySalesDate,'%d/%m/%Y %H:%i') as tgl_sales, 				DATE_FORMAT(b.CustomerRejectedDate,'%d/%m/%Y %H:%i') as tgl_approve, 				DATEDIFF(date(b.CustomerRejectedDate),date(f.PolicySalesDate)) as DayOffWeek,				i.CallReasonDesc as CallReasonId, j.AproveName as CollmonResultId,				a.CollmonPoint			FROM coll_report_collmon a 			LEFT JOIN t_gn_customer b on a.CustomerId=b.CustomerId			LEFT JOIN t_gn_campaign c on b.CampaignId=c.CampaignId			LEFT JOIN t_gn_assignment d on b.CustomerId=d.CustomerId			LEFT JOIN t_gn_policyautogen e on b.CustomerId=e.CustomerId			LEFT JOIN t_gn_policy f on e.PolicyNumber=f.PolicyNumber			LEFT JOIN tms_agent g on b.SellerId=g.UserId			LEFT JOIN tms_agent h on b.QueueId=h.UserId			LEFT JOIN t_lk_callreason i on b.CallReasonId=i.CallReasonId			LEFT JOIN t_lk_aprove_status j on a.CollmonResultId=j.ApproveId 			WHERE 1=1			AND DATE(a.CollmonCreateTs)>='$start_date' 			AND DATE(a.CollmonCreateTs)<='$end_date'			ORDER BY a.CollmonCreateTs DESC ";				//	echo "<pre>$sql</pre>";				$qry = $this -> query($sql);				$num = 1;		foreach( $qry -> result_assoc() as $rows )		{			echo "<tr>					<td class=\"content first\" nowrap>".$num."</td>					<td class=\"content middle\" nowrap>".$rows['CampaignName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerNumber']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerFirstName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCardType']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerAddressLine']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCity']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerZipCode']."</td>					<td class=\"content middle\" nowrap>".$rows['SellerName']."</td>					<td class=\"content middle\" nowrap>".$rows['QualityUser']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_sales']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_approve']."</td>					<td class=\"content middle\" align=\"center\" nowrap>".$rows['DayOffWeek']."</td>					<td class=\"content middle\" nowrap>".$rows['CallReasonId']."</td>					<td class=\"content middle\" nowrap>".$rows['CollmonResultId']."</td>					<td class=\"content lasted\" align=\"center\"  nowrap>".$rows['CollmonPoint']."</td>				</tr> "; 			$num++;			}							echo " <tr>				  <td class=\"total first\" nowrap colspan=\"16\">&nbsp;</td>				</tr> </table>";	 }				/** QualityDetailByQA() ****/	 function QualityDetailByQA() {	$QualityId = $this -> getWithIn($this -> escPost('group_select'));	$start_date = $this -> Date -> english( $this -> escPost('start_date'),'-' );	$end_date   = $this -> Date -> english( $this -> escPost('end_date'),'-' );	/** start header content table ***/				echo "<table class=\"grid\" cellpadding=\"0\" cellspacing=\"0\" >				<tr>				   <td class=\"header first\" nowrap>No</td>					  <td class=\"header middle\" nowrap>Campaign Name</td>				  <td class=\"header middle\" nowrap>Fine Code</td>				  <td class=\"header middle\" nowrap>Customer Name</td>				  <td class=\"header middle\" nowrap>Card Type</td>				  <td class=\"header middle\" nowrap>Address</td>				  <td class=\"header middle\" nowrap>City</td>				  <td class=\"header middle\" nowrap>Zip Code</td>				  <td class=\"header middle\" nowrap>Seller Name</td>				  <td class=\"header middle\" nowrap>Quality User</td>				  <td class=\"header middle\" nowrap>Sales Date</td>				  <td class=\"header middle\" nowrap>Approve Date</td>				  <td class=\"header middle\" nowrap align=\"center\">SLA <br>Quality</td>				  <td class=\"header middle\" nowrap>Call Reason</td>				  <td class=\"header middle\" nowrap align=\"center\" nowrap>Quality <br> Status</td>				  <td class=\"header lasted\" nowrap align=\"center\" nowrap>Quality <br> Score</td>			</tr> "; 						/** query data ******************/		$sql = " SELECT	c.CampaignName,  b.CustomerNumber, 				b.CustomerFirstName, b.CustomerCardType,				concat(					   b.CustomerAddressLine1,' ',b.CustomerAddressLine2,' ',					   b.CustomerAddressLine3 ,' ',b.CustomerAddressLine4 ) as CustomerAddressLine,				b.CustomerCity, b.CustomerZipCode, e.PolicyNumber,				CONCAT(g.id,' - ',g.full_name) as SellerName, 				CONCAT(h.id,' - ',h.full_name) as QualityUser, 				DATE_FORMAT(f.PolicySalesDate,'%d/%m/%Y %H:%i') as tgl_sales, 				DATE_FORMAT(b.CustomerRejectedDate,'%d/%m/%Y %H:%i') as tgl_approve, 				DATEDIFF(date(b.CustomerRejectedDate),date(f.PolicySalesDate)) as DayOffWeek,				i.CallReasonDesc as CallReasonId, j.AproveName as CollmonResultId,				a.CollmonPoint			FROM coll_report_collmon a 			LEFT JOIN t_gn_customer b on a.CustomerId=b.CustomerId			LEFT JOIN t_gn_campaign c on b.CampaignId=c.CampaignId			LEFT JOIN t_gn_assignment d on b.CustomerId=d.CustomerId			LEFT JOIN t_gn_policyautogen e on b.CustomerId=e.CustomerId			LEFT JOIN t_gn_policy f on e.PolicyNumber=f.PolicyNumber			LEFT JOIN tms_agent g on b.SellerId=g.UserId			LEFT JOIN tms_agent h on b.QueueId=h.UserId			LEFT JOIN t_lk_callreason i on b.CallReasonId=i.CallReasonId			LEFT JOIN t_lk_aprove_status j on a.CollmonResultId=j.ApproveId 			WHERE h.UserId IN('".$QualityId."')			AND DATE(a.CollmonCreateTs)>='$start_date' 			AND DATE(a.CollmonCreateTs)<='$end_date'			ORDER BY a.CollmonCreateTs DESC ";				//	echo "<pre>$sql</pre>";				$qry = $this -> query($sql);				$num = 1;		foreach( $qry -> result_assoc() as $rows )		{			echo "<tr>					<td class=\"content first\" nowrap>".$num."</td>					<td class=\"content middle\" nowrap>".$rows['CampaignName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerNumber']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerFirstName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCardType']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerAddressLine']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCity']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerZipCode']."</td>					<td class=\"content middle\" nowrap>".$rows['SellerName']."</td>					<td class=\"content middle\" nowrap>".$rows['QualityUser']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_sales']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_approve']."</td>					<td class=\"content middle\" align=\"center\" nowrap>".$rows['DayOffWeek']."</td>					<td class=\"content middle\" nowrap>".$rows['CallReasonId']."</td>					<td class=\"content middle\" nowrap>".$rows['CollmonResultId']."</td>					<td class=\"content lasted\" align=\"center\"  nowrap>".$rows['CollmonPoint']."</td>				</tr> "; 			$num++;			}							echo " <tr>				  <td class=\"total first\" nowrap colspan=\"16\">&nbsp;</td>				</tr> </table>";	 }		/** QualityDetailByAgent() ****/	 function QualityDetailByAgent() {	$SellerId = $this -> getWithIn($this -> escPost('group_select'));	$start_date = $this -> Date -> english( $this -> escPost('start_date'),'-' );	$end_date   = $this -> Date -> english( $this -> escPost('end_date'),'-' );	/** start header content table ***/				echo "<table class=\"grid\" cellpadding=\"0\" cellspacing=\"0\" >				<tr>				   <td class=\"header first\" nowrap>No</td>					  <td class=\"header middle\" nowrap>Campaign Name</td>				  <td class=\"header middle\" nowrap>Fine Code</td>				  <td class=\"header middle\" nowrap>Customer Name</td>				  <td class=\"header middle\" nowrap>Card Type</td>				  <td class=\"header middle\" nowrap>Address</td>				  <td class=\"header middle\" nowrap>City</td>				  <td class=\"header middle\" nowrap>Zip Code</td>				  <td class=\"header middle\" nowrap>Seller Name</td>				  <td class=\"header middle\" nowrap>Quality User</td>				  <td class=\"header middle\" nowrap>Sales Date</td>				  <td class=\"header middle\" nowrap>Approve Date</td>				  <td class=\"header middle\" nowrap align=\"center\">SLA <br>Quality</td>				  <td class=\"header middle\" nowrap>Call Reason</td>				  <td class=\"header middle\" nowrap align=\"center\" nowrap>Quality <br> Status</td>				  <td class=\"header lasted\" nowrap align=\"center\" nowrap>Quality <br> Score</td>			</tr> "; 						/** query data ******************/		$sql = " SELECT	c.CampaignName,  b.CustomerNumber, 				b.CustomerFirstName, b.CustomerCardType,				concat(					   b.CustomerAddressLine1,' ',b.CustomerAddressLine2,' ',					   b.CustomerAddressLine3 ,' ',b.CustomerAddressLine4 ) as CustomerAddressLine,				b.CustomerCity, b.CustomerZipCode, e.PolicyNumber,				CONCAT(g.id,' - ',g.full_name) as SellerName, 				CONCAT(h.id,' - ',h.full_name) as QualityUser, 				DATE_FORMAT(f.PolicySalesDate,'%d/%m/%Y %H:%i') as tgl_sales, 				DATE_FORMAT(b.CustomerRejectedDate,'%d/%m/%Y %H:%i') as tgl_approve, 				DATEDIFF(date(b.CustomerRejectedDate),date(f.PolicySalesDate)) as DayOffWeek,				i.CallReasonDesc as CallReasonId, j.AproveName as CollmonResultId,				a.CollmonPoint			FROM coll_report_collmon a 			LEFT JOIN t_gn_customer b on a.CustomerId=b.CustomerId			LEFT JOIN t_gn_campaign c on b.CampaignId=c.CampaignId			LEFT JOIN t_gn_assignment d on b.CustomerId=d.CustomerId			LEFT JOIN t_gn_policyautogen e on b.CustomerId=e.CustomerId			LEFT JOIN t_gn_policy f on e.PolicyNumber=f.PolicyNumber			LEFT JOIN tms_agent g on b.SellerId=g.UserId			LEFT JOIN tms_agent h on b.QueueId=h.UserId			LEFT JOIN t_lk_callreason i on b.CallReasonId=i.CallReasonId			LEFT JOIN t_lk_aprove_status j on a.CollmonResultId=j.ApproveId 			WHERE b.SellerId IN('".$SellerId."')			AND DATE(a.CollmonCreateTs)>='$start_date' 			AND DATE(a.CollmonCreateTs)<='$end_date'			ORDER BY a.CollmonCreateTs DESC ";				//	echo "<pre>$sql</pre>";				$qry = $this -> query($sql);				$num = 1;		foreach( $qry -> result_assoc() as $rows )		{			echo "<tr>					<td class=\"content first\" nowrap>".$num."</td>					<td class=\"content middle\" nowrap>".$rows['CampaignName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerNumber']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerFirstName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCardType']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerAddressLine']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCity']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerZipCode']."</td>					<td class=\"content middle\" nowrap>".$rows['SellerName']."</td>					<td class=\"content middle\" nowrap>".$rows['QualityUser']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_sales']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_approve']."</td>					<td class=\"content middle\" align=\"center\" nowrap>".$rows['DayOffWeek']."</td>					<td class=\"content middle\" nowrap>".$rows['CallReasonId']."</td>					<td class=\"content middle\" nowrap>".$rows['CollmonResultId']."</td>					<td class=\"content lasted\" align=\"center\"  nowrap>".$rows['CollmonPoint']."</td>				</tr> "; 			$num++;			}							echo " <tr>				  <td class=\"total first\" nowrap colspan=\"16\">&nbsp;</td>				</tr> </table>";	 }		/** QualityDetailByCampaign() ****/	 function QualityDetailByStatus() {	$Status = $this -> getWithIn($this -> escPost('group_select'));	$start_date = $this -> Date -> english( $this -> escPost('start_date'),'-' );	$end_date   = $this -> Date -> english( $this -> escPost('end_date'),'-' );	/** start header content table ***/				echo "<table class=\"grid\" cellpadding=\"0\" cellspacing=\"0\" >				<tr>				   <td class=\"header first\" nowrap>No</td>					  <td class=\"header middle\" nowrap>Campaign Name</td>				  <td class=\"header middle\" nowrap>Fine Code</td>				  <td class=\"header middle\" nowrap>Customer Name</td>				  <td class=\"header middle\" nowrap>Card Type</td>				  <td class=\"header middle\" nowrap>Address</td>				  <td class=\"header middle\" nowrap>City</td>				  <td class=\"header middle\" nowrap>Zip Code</td>				  <td class=\"header middle\" nowrap>Seller Name</td>				  <td class=\"header middle\" nowrap>Quality User</td>				  <td class=\"header middle\" nowrap>Sales Date</td>				  <td class=\"header middle\" nowrap>Approve Date</td>				  <td class=\"header middle\" nowrap align=\"center\">SLA <br>Quality</td>				  <td class=\"header middle\" nowrap>Call Reason</td>				  <td class=\"header middle\" nowrap align=\"center\" nowrap>Quality <br> Status</td>				  <td class=\"header lasted\" nowrap align=\"center\" nowrap>Quality <br> Score</td>			</tr> "; 						/** query data ******************/		$sql = " SELECT	c.CampaignName,  b.CustomerNumber, 				b.CustomerFirstName, b.CustomerCardType,				concat(					   b.CustomerAddressLine1,' ',b.CustomerAddressLine2,' ',					   b.CustomerAddressLine3 ,' ',b.CustomerAddressLine4 ) as CustomerAddressLine,				b.CustomerCity, b.CustomerZipCode, e.PolicyNumber,				CONCAT(g.id,' - ',g.full_name) as SellerName, 				CONCAT(h.id,' - ',h.full_name) as QualityUser, 				DATE_FORMAT(f.PolicySalesDate,'%d/%m/%Y %H:%i') as tgl_sales, 				DATE_FORMAT(b.CustomerRejectedDate,'%d/%m/%Y %H:%i') as tgl_approve, 				DATEDIFF(date(b.CustomerRejectedDate),date(f.PolicySalesDate)) as DayOffWeek,				i.CallReasonDesc as CallReasonId, j.AproveName as CollmonResultId,				a.CollmonPoint			FROM coll_report_collmon a 			LEFT JOIN t_gn_customer b on a.CustomerId=b.CustomerId			LEFT JOIN t_gn_campaign c on b.CampaignId=c.CampaignId			LEFT JOIN t_gn_assignment d on b.CustomerId=d.CustomerId			LEFT JOIN t_gn_policyautogen e on b.CustomerId=e.CustomerId			LEFT JOIN t_gn_policy f on e.PolicyNumber=f.PolicyNumber			LEFT JOIN tms_agent g on b.SellerId=g.UserId			LEFT JOIN tms_agent h on b.QueueId=h.UserId			LEFT JOIN t_lk_callreason i on b.CallReasonId=i.CallReasonId			LEFT JOIN t_lk_aprove_status j on a.CollmonResultId=j.ApproveId 			WHERE a.CollmonResultId IN('".$Status."')			AND DATE(a.CollmonCreateTs)>='$start_date' 			AND DATE(a.CollmonCreateTs)<='$end_date'			ORDER BY a.CollmonCreateTs DESC ";				//	echo "<pre>$sql</pre>";				$qry = $this -> query($sql);				$num = 1;		foreach( $qry -> result_assoc() as $rows )		{			echo "<tr>					<td class=\"content first\" nowrap>".$num."</td>					<td class=\"content middle\" nowrap>".$rows['CampaignName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerNumber']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerFirstName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCardType']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerAddressLine']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCity']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerZipCode']."</td>					<td class=\"content middle\" nowrap>".$rows['SellerName']."</td>					<td class=\"content middle\" nowrap>".$rows['QualityUser']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_sales']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_approve']."</td>					<td class=\"content middle\" align=\"center\" nowrap>".$rows['DayOffWeek']."</td>					<td class=\"content middle\" nowrap>".$rows['CallReasonId']."</td>					<td class=\"content middle\" nowrap>".$rows['CollmonResultId']."</td>					<td class=\"content lasted\" align=\"center\"  nowrap>".$rows['CollmonPoint']."</td>				</tr> "; 			$num++;			}							echo " <tr>				  <td class=\"total first\" nowrap colspan=\"16\">&nbsp;</td>				</tr> </table>";	 } /** QualityDetailByCampaign() ****/	 function QualityDetailByCampaign() {	$CampaignId = $this -> getWithIn($this -> escPost('group_select'));	$start_date = $this -> Date -> english( $this -> escPost('start_date'),'-' );	$end_date   = $this -> Date -> english( $this -> escPost('end_date'),'-' );	/** start header content table ***/				echo "<table class=\"grid\" cellpadding=\"0\" cellspacing=\"0\" >				<tr>				   <td class=\"header first\" nowrap>No</td>					  <td class=\"header middle\" nowrap>Campaign Name</td>				  <td class=\"header middle\" nowrap>Fine Code</td>				  <td class=\"header middle\" nowrap>Customer Name</td>				  <td class=\"header middle\" nowrap>Card Type</td>				  <td class=\"header middle\" nowrap>Address</td>				  <td class=\"header middle\" nowrap>City</td>				  <td class=\"header middle\" nowrap>Zip Code</td>				  <td class=\"header middle\" nowrap>Seller Name</td>				  <td class=\"header middle\" nowrap>Quality User</td>				  <td class=\"header middle\" nowrap>Sales Date</td>				  <td class=\"header middle\" nowrap>Approve Date</td>				  <td class=\"header middle\" nowrap align=\"center\">SLA <br>Quality</td>				  <td class=\"header middle\" nowrap>Call Reason</td>				  <td class=\"header middle\" nowrap align=\"center\" nowrap>Quality <br> Status</td>				  <td class=\"header lasted\" nowrap align=\"center\" nowrap>Quality <br> Score</td>			</tr> "; 						/** query data ******************/		$sql = " SELECT	c.CampaignName,  b.CustomerNumber, 				b.CustomerFirstName, b.CustomerCardType,				concat(					   b.CustomerAddressLine1,' ',b.CustomerAddressLine2,' ',					   b.CustomerAddressLine3 ,' ',b.CustomerAddressLine4 ) as CustomerAddressLine,				b.CustomerCity, b.CustomerZipCode, e.PolicyNumber,				CONCAT(g.id,' - ',g.full_name) as SellerName, 				CONCAT(h.id,' - ',h.full_name) as QualityUser, 				DATE_FORMAT(f.PolicySalesDate,'%d/%m/%Y %H:%i') as tgl_sales, 				DATE_FORMAT(b.CustomerRejectedDate,'%d/%m/%Y %H:%i') as tgl_approve, 				DATEDIFF(date(b.CustomerRejectedDate),date(f.PolicySalesDate)) as DayOffWeek,				i.CallReasonDesc as CallReasonId, j.AproveName as CollmonResultId,				a.CollmonPoint			FROM coll_report_collmon a 			LEFT JOIN t_gn_customer b on a.CustomerId=b.CustomerId			LEFT JOIN t_gn_campaign c on b.CampaignId=c.CampaignId			LEFT JOIN t_gn_assignment d on b.CustomerId=d.CustomerId			LEFT JOIN t_gn_policyautogen e on b.CustomerId=e.CustomerId			LEFT JOIN t_gn_policy f on e.PolicyNumber=f.PolicyNumber			LEFT JOIN tms_agent g on b.SellerId=g.UserId			LEFT JOIN tms_agent h on b.QueueId=h.UserId			LEFT JOIN t_lk_callreason i on b.CallReasonId=i.CallReasonId			LEFT JOIN t_lk_aprove_status j on a.CollmonResultId=j.ApproveId 			WHERE c.CampaignId IN('".$CampaignId."')			AND DATE(a.CollmonCreateTs)>='$start_date' 			AND DATE(a.CollmonCreateTs)<='$end_date'			ORDER BY a.CollmonCreateTs DESC ";				//	echo "<pre>$sql</pre>";				$qry = $this -> query($sql);				$num = 1;		foreach( $qry -> result_assoc() as $rows )		{			echo "<tr>					<td class=\"content first\" nowrap>".$num."</td>					<td class=\"content middle\" nowrap>".$rows['CampaignName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerNumber']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerFirstName']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCardType']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerAddressLine']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerCity']."</td>					<td class=\"content middle\" nowrap>".$rows['CustomerZipCode']."</td>					<td class=\"content middle\" nowrap>".$rows['SellerName']."</td>					<td class=\"content middle\" nowrap>".$rows['QualityUser']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_sales']."</td>					<td class=\"content middle\" nowrap>".$rows['tgl_approve']."</td>					<td class=\"content middle\" align=\"center\" nowrap>".$rows['DayOffWeek']."</td>					<td class=\"content middle\" nowrap>".$rows['CallReasonId']."</td>					<td class=\"content middle\" nowrap>".$rows['CollmonResultId']."</td>					<td class=\"content lasted\" align=\"center\"  nowrap>".$rows['CollmonPoint']."</td>				</tr> "; 			$num++;			}							echo " <tr>				  <td class=\"total first\" nowrap colspan=\"16\">&nbsp;</td>				</tr> </table>";	 }	}?> 