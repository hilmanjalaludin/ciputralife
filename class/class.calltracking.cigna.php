<?phprequire(dirname(__FILE__)."/../sisipan/sessions.php");require(dirname(__FILE__)."/../fungsi/global.php");require(dirname(__FILE__)."/../class/MYSQLConnect.php");require(dirname(__FILE__)."/../class/lib.form.php");class __CIGNA_CallTrack extends mysql{var $JPForm;public function __CIGNA_CallTrack(){		parent::__construct();		session_start();				self::index();	}		public function index(){	if( $this -> havepost('action'))	{		$this -> JPForm = new jpForm();				switch($_REQUEST['action'])		{			case 'get_filter_campaign' : $this -> getFilterCampaign(); 	break;			case 'get_filter_spv' : $this -> getFilterSupervisor();	break;			case 'get_filter_tm' : $this -> getFilterTelesales(); 	break;				case 'get_filter_campaign_empty' : $this -> getFilterCampaignEmpty(); 	break;			case 'get_filter_spv_empty' : $this -> getFilterSupervisorEmpty();	break;			case 'get_filter_tm_empty' : $this -> getFilterTelesalesEmpty(); 	break;				case 'get_filter_mode' : $this -> getFilterMode(); 	break;		}	}}/** ** mode report custom ** by post parameter **/ function getFilterMode(){	$_conds = array();		switch($_REQUEST['values'])	{		case '1': $_conds = array('hourly'=>'Hourly','daily'=>'Daily','weekly'=>'Weekly','summary'=>'Summary'); break;		case '2': $_conds = array('daily'=>'Daily','weekly'=>'Weekly','summary'=>'Summary'); break;		case '3': $_conds = array('weekly'=>'Weekly','summary'=>'Summary'); break;		case '4': $_conds = array('summary'=>'Summary'); break;		case '5': $_conds = array('all'=>'All'); break;	}		$this -> JPForm -> jpCombo('mode_cigna', 'xx004', $_conds, NULL, NULL);}public function getFilterCampaignEmpty(){	$datas = array();	switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_campaign', $label = 'Campaign Name',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_campaign', 'xx004', $datas); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_campaign','xx001',$datas); break;	}	}public function getFilterSupervisorEmpty(){	$datas = array();	switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_spv', $label = 'Supervisor',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_spv', 'xx004', $datas,NULL,'onchange="__CIGNA.GroupFilterBySPV(this);"'); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_spv','xx001',$datas); break;	}	}public function getFilterTelesalesEmpty(){	$datas = array();	switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_tm', $label = 'Campaign Name',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_tm', 'xx004', $datas); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_tm','xx001',$datas); break;	}	}//06-08-2014public function getFilterCampaign(){	switch($_REQUEST['R_type']){		case 'ref_report' : $this -> getFilterCampaign0(); 	break;		default 		  : $this -> getFilterCampaign1(); 	break;	}}//06-08-2014public function getFilterCampaign0(){	$sql = "select a.CampaignId, a.CampaignNumber, a.CampaignName from t_gn_campaign a ";	$qry = $this -> query($sql);	foreach( $qry -> result_assoc() as $rows ){		$datas[$rows['CampaignId']] = $rows['CampaignName'];	}		switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_campaign', $label = 'Campaign Name',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_campaign', 'xx004', $datas); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_campaign','xx001',$datas); break;	}	}//06-08-2014public function getFilterCampaign1(){	$sql = "select a.CampaignId, a.CampaignNumber, a.CampaignName from t_gn_campaign a where a.CampaignStatusFlag=1";	$qry = $this -> query($sql);	foreach( $qry -> result_assoc() as $rows ){		$datas[$rows['CampaignId']] = $rows['CampaignName'];	}		switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_campaign', $label = 'Campaign Name',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_campaign', 'xx004', $datas); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_campaign','xx001',$datas); break;	}	}public function getFilterSupervisor(){		if( $this -> getSession('handling_type')==USER_ROOT) {			$sql = " select a.UserId, a.full_name from tms_agent a  where a.handling_type=3 and a.user_state=1";		}			if( $this -> getSession('handling_type')==USER_ADMIN) {			$sql = " select a.UserId, a.full_name from tms_agent a  where a.handling_type=3 and a.user_state=1";		}			if( $this -> getSession('handling_type')==USER_QUALITY) {			$sql = " select a.UserId, a.full_name from tms_agent a  where a.handling_type=3 and a.user_state=1";		}			if( $this -> getSession('handling_type')==USER_MANAGER) {			$sql = " select a.UserId, a.full_name from tms_agent a 					 where a.handling_type=3 and a.user_state=1 ";		}			if( $this -> getSession('handling_type')==USER_SUPERVISOR) {			$sql = " select a.UserId, a.full_name from tms_agent a 					 where a.handling_type=3 and a.user_state=1 					 and a.UserId='".$_SESSION['UserId']."'";		}			$qry = $this -> query($sql);	foreach( $qry -> result_assoc() as $rows )		{			$datas[$rows['UserId']] = $rows['full_name'];				}				switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_spv', $label = 'Supervisor',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_spv', 'xx004', $datas,NULL,'onchange="__CIGNA.GroupFilterBySPV(this);"'); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_spv','xx001',$datas); break;	}	}public function getFilterTelesales(){	if($this -> getSession('handling_type')==USER_ADMIN)		$sql = " select a.UserId, a.full_name from tms_agent a where a.handling_type=4 and a.user_state=1";	else if($this -> getSession('handling_type')==USER_MANAGER)		$sql = " select a.UserId, a.full_name from tms_agent a  where a.handling_type=4 and a.user_state=1 ";	else if($this -> getSession('handling_type')==USER_SUPERVISOR) 		$sql = " select a.UserId, a.full_name from tms_agent a where a.handling_type=4 and a.user_state=1 and a.spv_id='".$_SESSION['UserId']."'";	else		$sql = " select a.UserId, a.full_name from tms_agent a where a.handling_type=4 and a.user_state=1";					if($this -> havepost('values')) $sql.=" AND a.spv_id='".$_REQUEST['values']."'";	$qry = $this -> query($sql);	foreach( $qry -> result_assoc() as $rows )	{		$datas[$rows['UserId']] = $rows['full_name'];	}		switch($_REQUEST['Type']){		case 'box' : $this -> JPForm -> jpListcombo('group_filter_tm', $label = 'Telesales',$datas,$values = NULL, $js = NULL,$attr = false, $dis=0); break;		case 'cmb' : $this -> JPForm -> jpCombo('group_filter_tm', 'xx004', $datas); break;		case 'mtp' : $this -> JPForm -> jpMultiple('group_filter_tm','xx001',$datas); break;	}	}		}new __CIGNA_CallTrack();?>